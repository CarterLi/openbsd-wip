NOT FINISHED YET, only tested on amd64.
