$OpenBSD$
--- src/rpc/virnetsocket.c.orig	Mon Sep  3 14:10:12 2012
+++ src/rpc/virnetsocket.c	Mon Sep  3 14:12:03 2012
@@ -31,6 +31,8 @@
 #include <fcntl.h>
 #include <netdb.h>
 
+#include <sys/ucred.h>
+
 #ifdef HAVE_NETINET_TCP_H
 # include <netinet/tcp.h>
 #endif
@@ -999,9 +1001,9 @@ int virNetSocketGetUNIXIdentity(virNetSocketPtr sock,
         return -1;
     }
 
-    *pid = cr.pid;
-    *uid = cr.uid;
-    *gid = cr.gid;
+    *pid = getpid();
+    *uid = cr.cr_uid;
+    *gid = cr.cr_gid;
 
     virMutexUnlock(&sock->lock);
     return 0;
