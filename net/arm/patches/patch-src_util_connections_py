$OpenBSD$
upstream git b9446bdbb6df24fb0f042852a42e4d548c993263
--- src/util/connections.py.orig	Sun Apr 29 05:59:24 2012
+++ src/util/connections.py	Mon Apr 30 23:41:11 2012
@@ -203,7 +203,7 @@ def getResolverCommand(resolutionCmd, processName, pro
   if resolutionCmd == Resolver.PROC: return ""
   elif resolutionCmd == Resolver.NETSTAT: return RUN_NETSTAT % (processPid, processName)
   elif resolutionCmd == Resolver.SS: return RUN_SS % (processName, processPid)
-  elif resolutionCmd == Resolver.LSOF: return RUN_LSOF % (processName, processPid)
+  elif resolutionCmd == Resolver.LSOF: return RUN_LSOF % ("tor", processPid)
   elif resolutionCmd == Resolver.SOCKSTAT: return RUN_SOCKSTAT % (processName, processPid)
   elif resolutionCmd == Resolver.BSD_SOCKSTAT: return RUN_BSD_SOCKSTAT % (processName, processPid)
   elif resolutionCmd == Resolver.BSD_PROCSTAT: return RUN_BSD_PROCSTAT % processPid
