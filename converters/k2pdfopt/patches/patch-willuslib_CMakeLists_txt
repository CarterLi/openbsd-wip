$OpenBSD$

Index: willuslib/CMakeLists.txt
--- willuslib/CMakeLists.txt.orig
+++ willuslib/CMakeLists.txt
@@ -6,7 +6,7 @@ include_directories(..)
 set(WILLUSLIB_SRC
     ansi.c array.c bmp.c bmpdjvu.c bmpmupdf.c dtcompress.c filelist.c
     fontdata.c fontrender.c gslpolyfit.c linux.c math.c mem.c ocr.c
-    ocrjocr.c ocrtess.c pdfwrite.c point2d.c render.c strbuf.c string.c
+    ocrtess.c pdfwrite.c point2d.c render.c strbuf.c string.c
     token.c wfile.c wgs.c wgui.c willusversion.c win.c winbmp.c
     wincomdlg.c winmbox.c winshell.c wmupdf.c wmupdfinfo.c wpdf.c wsys.c
     wzfile.c wleptonica.c
@@ -21,10 +21,16 @@ endif(DJVU_FOUND)
 if(MUPDF_FOUND)
   set(WILLUSLIB_SRC ${WILLUSLIB_SRC} bmpmupdf.c wmupdf.c)
 endif(MUPDF_FOUND)
+if(MUPDF_LIB)
+  set(WILLUSLIB_SRC ${WILLUSLIB_SRC} bmpmupdf.c wmupdf.c)
+endif(MUPDF_LIB)
 
 message("-- Willuslib sources: ${WILLUSLIB_SRC}")
 
 add_library(willuslib ${WILLUSLIB_SRC})
+if(MUPDF_LIB)
+  target_link_libraries(willuslib ${MUPDF_LIB})
+endif(MUPDF_LIB)
 
 # HAVE_GOCR_LIB: ocrjocr.c
 # HAVE_TESSERACT_LIB: ocrtess.c 
