Needs testing with different logs and update testing.
