Almost work. Needs testing.
Need to fix startup script.
