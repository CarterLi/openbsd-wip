$OpenBSD$

strlcat

Index: codemp/ui/ui_gameinfo.c
--- codemp/ui/ui_gameinfo.c.orig
+++ codemp/ui/ui_gameinfo.c
@@ -82,14 +82,14 @@ int UI_ParseInfos( char *buf, int max, char *infos[] )
 
 			token = COM_ParseExt( (const char **)&buf, qfalse );
 			if ( !token[0] ) {
-				strcpy( token, "<NULL>" );
+				strlcpy( token, "<NULL>" , sizeof(token));
 			}
 			Info_SetValueForKey( info, key, token );
 		}
 		//NOTE: extra space for arena number
 		infos[count] = (char *) UI_Alloc(strlen(info) + strlen("\\num\\") + strlen(va("%d", MAX_ARENAS)) + 1);
 		if (infos[count]) {
-			strcpy(infos[count], info);
+			strlcpy(infos[count], info, sizeof(infos[count]));
 #ifndef FINAL_BUILD
 			if (trap->Cvar_VariableValue("com_buildScript"))
 			{
@@ -163,8 +163,8 @@ void UI_LoadArenas( void ) {
 	dirptr  = dirlist;
 	for (i = 0; i < numdirs; i++, dirptr += dirlen+1) {
 		dirlen = strlen(dirptr);
-		strcpy(filename, "scripts/");
-		strcat(filename, dirptr);
+		strlcpy(filename, "scripts/", sizeof(filename));
+		strlcat(filename, dirptr, sizeof(filename));
 		UI_LoadArenasFromFile(filename);
 	}
 //	trap->Print( "%i arenas parsed\n", ui_numArenas );
@@ -306,8 +306,8 @@ void UI_LoadBots( void ) {
 	dirptr  = dirlist;
 	for (i = 0; i < numdirs; i++, dirptr += dirlen+1) {
 		dirlen = strlen(dirptr);
-		strcpy(filename, "scripts/");
-		strcat(filename, dirptr);
+		strlcpy(filename, "scripts/", sizeof(filename));
+		strlcat(filename, dirptr, sizeof(filename));
 		UI_LoadBotsFromFile(filename);
 	}
 //	trap->Print( "%i bots parsed\n", ui_numBots );
