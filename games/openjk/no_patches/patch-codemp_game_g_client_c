$OpenBSD$

strlcat

Index: codemp/game/g_client.c
--- codemp/game/g_client.c.orig
+++ codemp/game/g_client.c
@@ -1621,7 +1621,7 @@ void SetupGameGhoul2Model(gentity_t *ent, char *modeln
 
 				Q_strncpyz( vehicleName, modelname, sizeof( vehicleName ) );
 				BG_GetVehicleModelName(realModelName, modelname, sizeof( realModelName ));
-				strcpy(truncModelName, realModelName);
+				strlcpy(truncModelName, realModelName, sizeof(truncModelName));
 				skin[0] = 0;
 				if ( ent->m_pVehicle
 					&& ent->m_pVehicle->m_pVehicleInfo
@@ -1639,14 +1639,14 @@ void SetupGameGhoul2Model(gentity_t *ent, char *modeln
 			{
 				if (skinName && skinName[0])
 				{
-					strcpy(skin, skinName);
-					strcpy(truncModelName, modelname);
+					strlcpy(skin, skinName, sizeof(skin));
+					strlcpy(truncModelName, modelname, sizeof(truncModelName));
 				}
 				else
 				{
-					strcpy(skin, "default");
+					strlcpy(skin, "default", sizeof(skin));
 
-					strcpy(truncModelName, modelname);
+					strlcpy(truncModelName, modelname, sizeof(truncModelName));
 					p = Q_strrchr(truncModelName, '/');
 
 					if (p)
@@ -1666,8 +1666,8 @@ void SetupGameGhoul2Model(gentity_t *ent, char *modeln
 
 					if (!BG_IsValidCharacterModel(truncModelName, skin))
 					{
-						strcpy(truncModelName, DEFAULT_MODEL);
-						strcpy(skin, "default");
+						strlcpy(truncModelName, DEFAULT_MODEL, sizeof(truncModelName));
+						strlcpy(skin, "default", sizeof(skin));
 					}
 
 					if ( level.gametype >= GT_TEAM && level.gametype != GT_SIEGE && !g_jediVmerc.integer )
@@ -1718,7 +1718,7 @@ void SetupGameGhoul2Model(gentity_t *ent, char *modeln
 				skinHandle = trap->R_RegisterSkin(useSkinName);
 			}
 
-			strcpy(modelFullPath, va("models/players/%s/model.glm", truncModelName));
+			strlcpy(modelFullPath, va("models/players/%s/model.glm", truncModelName), sizeof(modelFullPath));
 			handle = trap->G2API_InitGhoul2Model(&ent->ghoul2, modelFullPath, 0, skinHandle, -20, 0, 0);
 
 			if (handle<0)
@@ -1751,7 +1751,7 @@ void SetupGameGhoul2Model(gentity_t *ent, char *modeln
 
 					if (skin[0])
 					{ //append it after a *
-						strcat( modelFullPath, va("*%s", skin) );
+						strlcat( modelFullPath, va("*%s", skin) , sizeof(modelFullPath));
 					}
 
 					if ( ent->client->NPC_class == CLASS_VEHICLE )
@@ -1806,7 +1806,7 @@ void SetupGameGhoul2Model(gentity_t *ent, char *modeln
 			char *slash = Q_strrchr( GLAName, '/' );
 			if ( slash )
 			{
-				strcpy(slash, "/animation.cfg");
+				strlcpy(slash, "/animation.cfg", sizeof(slash));
 
 				ent->localAnimIndex = BG_ParseAnimationFile(GLAName, NULL, qfalse);
 			}
