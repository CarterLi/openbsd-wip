$OpenBSD$

strlcpy

Index: codemp/game/bg_panimate.c
--- codemp/game/bg_panimate.c.orig
+++ codemp/game/bg_panimate.c
@@ -1906,7 +1906,7 @@ void ParseAnimationEvtBlock(const char *aeb_filename, 
 			{
 				break;
 			}
-			strcpy(stringData, token);
+			strlcpy(stringData, token, sizeof(stringData));
 			//get lowest value
 			token = COM_Parse( text_p );
 			if ( !token )
@@ -2058,7 +2058,7 @@ void ParseAnimationEvtBlock(const char *aeb_filename, 
 				{ //eh, whatever. no dynamic stuff, so this will do.
 					animEvents[curAnimEvent].stringData = (char *) BG_Alloc(2048);
 				}
-				strcpy(animEvents[curAnimEvent].stringData, token);
+				strlcpy(animEvents[curAnimEvent].stringData, token, sizeof(animEvents[curAnimEvent].stringData));
 			}
 			//NOTE: this string will later be used to add a bolt and store the index, as below:
 			//animEvent->eventData[AED_BOLTINDEX] = trap->G2API_AddBolt( &cent->gent->ghoul2[cent->gent->playerModel], animEvent->stringData );
@@ -2259,7 +2259,7 @@ int BG_ParseAnimationEvtFile( const char *as_filename,
 			if ( include_filename != NULL )
 			{
 				char fullIPath[MAX_QPATH];
-				strcpy(fullIPath, va("models/players/%s/", include_filename));
+				strlcpy(fullIPath, va("models/players/%s/", include_filename), sizeof(fullIPath));
 				bg_animParseIncluding++;
 				BG_ParseAnimationEvtFile( fullIPath, animFileIndex, forcedIndex );
 				bg_animParseIncluding--;
@@ -2283,7 +2283,7 @@ fin:
 	if (bg_animParseIncluding <= 0)
 	{ //if we should be parsing an included file, skip this part
 		bgAllEvents[forcedIndex].eventsParsed = qtrue;
-		strcpy(bgAllEvents[forcedIndex].filename, as_filename);
+		strlcpy(bgAllEvents[forcedIndex].filename, as_filename, sizeof(bgAllEvents[forcedIndex].filename));
 		if (forcedIndex)
 		{
 			bgNumAnimEvents++;
@@ -2510,7 +2510,7 @@ int BG_ParseAnimationFile(const char *filename, animat
 	if (isHumanoid)
 	{
 		bgAllAnims[0].anims = animset;
-		strcpy(bgAllAnims[0].filename, filename);
+		strlcpy(bgAllAnims[0].filename, filename, sizeof(bgAllAnims[0].filename));
 		BGPAFtextLoaded = qtrue;
 
 		usedIndex = 0;
@@ -2518,7 +2518,7 @@ int BG_ParseAnimationFile(const char *filename, animat
 	else
 	{
 		bgAllAnims[nextIndex].anims = animset;
-		strcpy(bgAllAnims[nextIndex].filename, filename);
+		strlcpy(bgAllAnims[nextIndex].filename, filename, sizeof(bgAllAnims[nextIndex].filename));
 
 		usedIndex = bgNumAllAnims;
 
