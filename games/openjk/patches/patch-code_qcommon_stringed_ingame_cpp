$OpenBSD$

strlcat

Index: code/qcommon/stringed_ingame.cpp
--- code/qcommon/stringed_ingame.cpp.orig
+++ code/qcommon/stringed_ingame.cpp
@@ -180,7 +180,7 @@ char *CStringEdPackage::Filename_PathOnly(const char *
 {
 	static char sString[ iSE_MAX_FILENAME_LENGTH ];
 
-	strcpy(sString,psFilename);
+	strlcpy(sString,psFilename, sizeof(sString));
 
 	char *p1= strrchr(sString,'\\');
 	char *p2= strrchr(sString,'/');
@@ -202,7 +202,7 @@ char *CStringEdPackage::Filename_WithoutExt(const char
 {
 	static char sString[ iSE_MAX_FILENAME_LENGTH ];
 
-	strcpy(sString,psFilename);
+	strlcpy(sString,psFilename, sizeof(sString));
 
 	char *p = strrchr(sString,'.');
 	char *p2= strrchr(sString,'\\');
@@ -238,7 +238,7 @@ char *CStringEdPackage::Filename_WithoutPath(const cha
 		psFilename++;
 	}
 
-	strcpy(sString,psCopyPos);
+	strlcpy(sString,psCopyPos, sizeof(sString));
 
 	return sString;
 }
@@ -254,7 +254,7 @@ void CStringEdPackage::SetupNewFileParse( const char *
 {
 	char sString[ iSE_MAX_FILENAME_LENGTH ];
 
-	strcpy(sString, Filename_WithoutPath( Filename_WithoutExt( psFileName ) ));
+	strlcpy(sString, Filename_WithoutPath( Filename_WithoutExt( psFileName ) ), sizeof(sString));
 	Q_strupr(sString);
 
 	m_strCurrentFileRef_ParseOnly = sString;	// eg "OBJECTIVES"
@@ -378,7 +378,7 @@ SE_BOOL CStringEdPackage::ReadLine( const char *&psPar
 		{
 			// last line...
 			//
-			strcpy(psDest, psParsePos);
+			strlcpy(psDest, psParsePos, sizeof(psDest));
 			psParsePos += strlen(psParsePos);
 		}
 
@@ -933,15 +933,15 @@ const char *SE_Load( const char *psFileName, SE_BOOL b
 	char sTemp[1000]={0};
 	if (!strchr(psFileName,'/'))
 	{
-		strcpy(sTemp,sSE_STRINGS_DIR);
-		strcat(sTemp,"/");
+		strlcpy(sTemp,sSE_STRINGS_DIR, sizeof(sTemp));
+		strlcat(sTemp,"/", sizeof(sTemp));
 		if (se_language)
 		{
-			strcat(sTemp,se_language->string);
-			strcat(sTemp,"/");
+			strlcat(sTemp,se_language->string, sizeof(sTemp));
+			strlcat(sTemp,"/", sizeof(sTemp));
 		}
 	}
-	strcat(sTemp,psFileName);
+	strlcat(sTemp,psFileName, sizeof(sTemp));
 	COM_DefaultExtension( sTemp, sizeof(sTemp), sSE_INGAME_FILE_EXTENSION);
 	psFileName = &sTemp[0];
 	//
@@ -960,7 +960,7 @@ const char *SE_Load( const char *psFileName, SE_BOOL b
 		char *p = strrchr( sFileName, '.' );
 		if (p && strlen(p) == strlen(sSE_EXPORT_FILE_EXTENSION))
 		{
-			strcpy( p, sSE_EXPORT_FILE_EXTENSION );
+			strlcpy( p, sSE_EXPORT_FILE_EXTENSION , sizeof(p));
 
 			psErrorMessage = SE_Load_Actual( sFileName, bLoadDebug, SE_TRUE );
 		}
