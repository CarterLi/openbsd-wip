$OpenBSD$
--- modules/highgui/src/cap_ffmpeg_impl.hpp.orig	Sun Jun 10 21:36:39 2012
+++ modules/highgui/src/cap_ffmpeg_impl.hpp	Wed Nov  7 21:11:11 2012
@@ -44,6 +44,7 @@
 #include <assert.h>
 #include <algorithm>
 #include <limits>
+#include <sys/param.h>
 
 #if defined _MSC_VER && _MSC_VER >= 1200
 #pragma warning( disable: 4244 4510 4512 4610 )
@@ -134,7 +135,7 @@ extern "C" {
 #define MIN(a, b) ((a) < (b) ? (a) : (b))
 #endif
 
-#if defined(__APPLE__)
+#if defined(__APPLE__) || defined(__OpenBSD__)
 #define AV_NOPTS_VALUE_ ((int64_t)0x8000000000000000LL)
 #else
 #define AV_NOPTS_VALUE_ ((int64_t)AV_NOPTS_VALUE)
@@ -149,7 +150,7 @@ int get_number_of_cpus(void)
     GetSystemInfo( &sysinfo );
 
     return (int)sysinfo.dwNumberOfProcessors;
-#elif defined __linux__
+#elif defined __linux__ || defined BSD
     return (int)sysconf( _SC_NPROCESSORS_ONLN );
 #elif defined __APPLE__
     int numCPU=0;
@@ -1045,7 +1046,7 @@ int icv_av_write_frame_FFMPEG( AVFormatContext * oc, A
             av_init_packet(&pkt);
 
 #if LIBAVFORMAT_BUILD > 4752
-            if(c->coded_frame->pts != (int64_t)AV_NOPTS_VALUE)
+            if(c->coded_frame->pts != AV_NOPTS_VALUE_)
 				pkt.pts = av_rescale_q(c->coded_frame->pts, c->time_base, video_st->time_base);
 #else
             pkt.pts = c->coded_frame->pts;
